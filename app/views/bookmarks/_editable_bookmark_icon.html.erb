<% resource ||= nil %>

<% if resource %>
  <% klass = resource.class %>

  <%= turbo_frame_tag dom_id(resource, :bookmark) do %>
    <%= turbo_flash %>
    <% if resource.bookmarks.any? { |b| b.user_id == current_user.id } %>
      <%= link_to bookmark_path(current_user.bookmark_for(resource),
                                from: "#{klass.table_name}_index",
                                **request.query_parameters,
                                anchor: "#{klass.model_name.singular}-#{resource.id}-anchor"),
                  class: "inline-block",
                  data: { turbo_method: :delete, turbo_confirm: "Remove bookmark?" } do %>
        <i class="fas fa-bookmark w-5 h-5 text-blue-500 hover:text-gray-400"></i>
      <% end %>
    <% else %>
      <%= link_to bookmarks_path(bookmark: { bookmarkable_id: resource.id,
                                             bookmarkable_type: "Resource" },
                                 from: "#{klass.table_name}_index",
                                 **request.query_parameters,
                                 anchor: "#{klass.model_name.singular}-#{resource.id}-anchor"),
                  class: "inline-block",
                  data: {turbo_method: :post} do %>
        <i class="far fa-bookmark w-5 h-5 text-gray-400 hover:text-blue-500"></i>
      <% end %>
    <% end %>
  <% end %>
<% end %>
